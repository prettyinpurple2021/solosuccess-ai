exports.id=400,exports.ids=[400,4291],exports.modules={10154:(a,b,c)=>{"use strict";c.d(b,{$:()=>f});var d=c(30477),e=c(2995);e.Ik({messageId:e.Yj().uuid(),fromAgent:e.Yj(),toAgents:e.YO(e.Yj()),routingType:e.k5(["direct","broadcast","conditional"]),priority:e.k5(["low","medium","high","urgent"]),timestamp:e.p6(),deliveryStatus:e.k5(["pending","delivered","failed","acknowledged"]),retryCount:e.ai().default(0),maxRetries:e.ai().default(3)});class f{constructor(a){this.routingHistory=new Map,this.messageQueue=new Map,this.routingRules=new Map,this.messageStats={totalMessages:0,successfulDeliveries:0,failedDeliveries:0,averageDeliveryTime:0},this.collaborationHub=a,this.initializeDefaultRoutingRules()}async routeMessage(a){let b=Date.now();try{if(!a.sessionId)throw Error("Message must have a session ID");let c=await this.applyRoutingRules(a);if(!c)return{messageId:a.id,successful:[],failed:[{agentId:"system",error:"Message blocked by routing rules"}],totalRecipients:0,deliveryTime:Date.now()-b};let d=await this.determineRecipients(c);if(0===d.length)return{messageId:a.id,successful:[],failed:[{agentId:"system",error:"No valid recipients found"}],totalRecipients:0,deliveryTime:Date.now()-b};let e={messageId:a.id,fromAgent:a.fromAgent,toAgents:d,routingType:null===a.toAgent?"broadcast":"direct",priority:a.priority||"medium",timestamp:new Date,deliveryStatus:"pending",retryCount:0,maxRetries:3};this.routingHistory.set(a.id,e);let f=await this.deliverMessage(c,d);return e.deliveryStatus=0===f.failed.length?"delivered":"failed",this.routingHistory.set(a.id,e),this.updateMessageStats(f),await this.persistMessage(c,f),{...f,deliveryTime:Date.now()-b}}catch(c){return(0,d.vV)("Error routing message:",c),{messageId:a.id,successful:[],failed:[{agentId:"system",error:c instanceof Error?c.message:"Unknown error"}],totalRecipients:0,deliveryTime:Date.now()-b}}}async broadcastMessage(a,b){let c={...a,toAgent:null,messageType:"broadcast"},d=this.collaborationHub.getSession(a.sessionId);if(!d)throw Error(`Session ${a.sessionId} not found`);let e=d.participatingAgents.filter(c=>c!==a.fromAgent&&!b?.includes(c));return this.deliverMessage(c,e)}async findBestAgent(a,b){let c=this.collaborationHub.getSession(b);if(!c)return null;let d=c.participatingAgents.filter(b=>!a.excludeAgents?.includes(b)).map(a=>this.collaborationHub.getAgent(a)).filter(Boolean);if(0===d.length)return null;let e=d.map(b=>{let c=0;if(a.requiredCapabilities?.length){let d=a.requiredCapabilities.filter(a=>b.capabilities.some(b=>b.toLowerCase().includes(a.toLowerCase())||a.toLowerCase().includes(b.toLowerCase())));c+=10*d.length}let d=a.content.toLowerCase();return b.specializations.forEach(a=>{d.includes(a.toLowerCase().replace("-"," "))&&(c+=5)}),c+=(b.maxConcurrentSessions-b.currentSessions.length)*2+Math.max(0,5e3-b.responseTimeMs)/1e3,{agent:b,score:c}}).reduce((a,b)=>b.score>a.score?b:a);return e.score>0?e.agent.id:d[0].id}async establishCommunicationChannel(a,b){let c=crypto.randomUUID(),e=this.collaborationHub.getSession(b);if(!e)throw Error(`Session ${b} not found`);let f=a.filter(a=>e.participatingAgents.includes(a));if(f.length<2)throw Error("At least 2 valid agents required for communication channel");let g={id:c,name:`Channel for agents: ${f.join(", ")}`,condition:a=>a.sessionId===b&&f.includes(a.fromAgent)&&a.metadata?.channelId===c,action:"route",targetAgents:f,priority:"medium",enabled:!0};return this.routingRules.set(c,g),(0,d.fH)(`âœ… Communication channel ${c} established for agents: ${f.join(", ")}`),c}getRoutingHistory(a){return Array.from(this.routingHistory.values()).filter(a=>!0)}getRoutingStats(){let a=Array.from(this.messageQueue.values()).reduce((a,b)=>a+b.length,0);return{...this.messageStats,queueSize:a}}async applyRoutingRules(a){for(let b of this.routingRules.values())if(b.enabled)try{if(b.condition(a))switch(b.action){case"block":return(0,d.fH)(`Message ${a.id} blocked by rule: ${b.name}`),null;case"transform":b.priority&&(a.priority=b.priority);break;case"route":b.targetAgents?.length&&(a.toAgent=b.targetAgents[0],a.metadata={...a.metadata,alternativeTargets:b.targetAgents.slice(1)});break;case"duplicate":b.targetAgents?.length&&b.targetAgents.forEach(b=>{if(b!==a.fromAgent){let c={...a,id:crypto.randomUUID(),toAgent:b,metadata:{...a.metadata,duplicatedFrom:a.id}};this.addToQueue(b,c)}})}}catch(a){(0,d.vV)(`Error applying routing rule ${b.name}:`,a)}return a}async determineRecipients(a){if(null!==a.toAgent)return[a.toAgent];{let b=this.collaborationHub.getSession(a.sessionId);return b?b.participatingAgents.filter(b=>b!==a.fromAgent):[]}}async deliverMessage(a,b){let c=[],d=[];for(let e of b)try{if(!this.collaborationHub.getAgent(e)){d.push({agentId:e,error:"Agent not found"});continue}this.addToQueue(e,a),c.push(e)}catch(a){d.push({agentId:e,error:a instanceof Error?a.message:"Unknown delivery error"})}return{messageId:a.id,successful:c,failed:d,totalRecipients:b.length,deliveryTime:0}}addToQueue(a,b){this.messageQueue.has(a)||this.messageQueue.set(a,[]);let c=this.messageQueue.get(a),d={urgent:0,high:1,medium:2,low:3},e=d[b.priority||"medium"],f=c.length;for(let a=0;a<c.length;a++)if(e<d[c[a].priority||"medium"]){f=a;break}c.splice(f,0,b)}getNextMessage(a){let b=this.messageQueue.get(a);return b?.shift()||null}updateMessageStats(a){this.messageStats.totalMessages++,this.messageStats.successfulDeliveries+=a.successful.length,this.messageStats.failedDeliveries+=a.failed.length;let b=(this.messageStats.averageDeliveryTime*(this.messageStats.totalMessages-1)+a.deliveryTime)/this.messageStats.totalMessages;this.messageStats.averageDeliveryTime=b}async persistMessage(a,b){(0,d.fH)(`ðŸ“¨ Message routed: ${a.fromAgent} -> ${b.successful.join(", ")}`)}initializeDefaultRoutingRules(){let a=[{id:"urgent-priority-boost",name:"Boost urgent messages",condition:a=>a.content.toLowerCase().includes("urgent")||a.content.includes("!!!"),action:"transform",priority:"urgent",enabled:!0},{id:"handoff-routing",name:"Route handoff messages",condition:a=>"handoff"===a.messageType,action:"route",priority:"high",enabled:!0},{id:"broadcast-limiter",name:"Limit broadcast spam",condition:a=>"broadcast"===a.messageType&&a.content.length<10,action:"block",enabled:!0}];a.forEach(a=>{this.routingRules.set(a.id,a)}),(0,d.fH)(`âœ… Message Router initialized with ${a.length} default routing rules`)}addRoutingRule(a){this.routingRules.set(a.id,a)}removeRoutingRule(a){return this.routingRules.delete(a)}getRoutingRules(){return Array.from(this.routingRules.values())}}},30477:(a,b,c)=>{"use strict";c.d(b,{HG:()=>i,JE:()=>g,fH:()=>h,vF:()=>e,vV:()=>f});class d{constructor(){this.isDevelopment=!1,this.logLevel=this.isDevelopment?3:2}shouldLog(a){return a<=this.logLevel}formatLogEntry(a){let b=["ERROR","WARN","INFO","DEBUG"][a.level],c=`[${a.timestamp}] ${b}: ${a.message}`;return a.context&&Object.keys(a.context).length>0&&(c+=` | Context: ${JSON.stringify(a.context)}`),a.error&&(c+=` | Error: ${a.error.message}`,this.isDevelopment&&a.error.stack&&(c+=` | Stack: ${a.error.stack}`)),c}log(a,b,c,d){if(!this.shouldLog(a))return;let e={level:a,message:b,timestamp:new Date().toISOString(),context:c,error:d},f=this.formatLogEntry(e);0===a&&console.error(f),!this.isDevelopment&&a<=1&&this.sendToExternalService(e)}async sendToExternalService(a){}error(a,b,c){this.log(0,a,b,c)}warn(a,b){this.log(1,a,b)}info(a,b){this.log(2,a,b)}debug(a,b){this.log(3,a,b)}apiLog(a,b,c,d,e){let f=`${a} ${b} - ${c}${d?` (${d}ms)`:""}`,g=c>=500?0:c>=400?1:2;this.log(g,f,{method:a,path:b,statusCode:c,duration:d,...e})}dbLog(a,b,c,d){let e=`DB ${a} on ${b}${c?` (${c}ms)`:""}`;this.log(3,e,{operation:a,table:b,duration:c,...d})}authLog(a,b,c=!0,d){let e=`Auth ${a}${b?` for user ${b}`:""} - ${c?"SUCCESS":"FAILED"}`;this.log(c?2:1,e,{action:a,userId:b,success:c,...d})}}let e=new d,f=(a,b,c)=>{b instanceof Error?e.error(a,void 0,b):"object"==typeof b&&null!==b?e.error(a,b,c):e.error(a,void 0,c)},g=(a,b)=>e.warn(a,b),h=(a,b)=>e.info(a,b),i=(a,b,c,d,f)=>e.apiLog(a,b,c,d,f)},43008:(a,b,c)=>{"use strict";c.d(b,{vE:()=>g});var d=c(30477),e=c(2995);let f=e.Ik({id:e.Yj().uuid(),sessionId:e.Yj().uuid(),agentId:e.Yj(),contextType:e.k5(["conversation","task","knowledge","preference","state"]),key:e.Yj(),value:e.bz(),timestamp:e.p6(),expiresAt:e.p6().optional(),priority:e.k5(["low","medium","high","critical"]).default("medium"),tags:e.YO(e.Yj()).default([]),metadata:e.g1(e.bz()).optional()});e.Ik({sessionId:e.Yj().uuid(),participants:e.YO(e.Yj()),currentTopic:e.Yj().optional(),conversationHistory:e.YO(e.Ik({messageId:e.Yj().uuid(),agentId:e.Yj(),content:e.Yj(),timestamp:e.p6(),importance:e.k5(["low","medium","high"]).default("medium")})),sharedKnowledge:e.g1(e.bz()).default({}),activeGoals:e.YO(e.Ik({id:e.Yj(),description:e.Yj(),assignedAgent:e.Yj().optional(),status:e.k5(["pending","active","completed","blocked"]),priority:e.k5(["low","medium","high"]).default("medium")})).default([]),contextSummary:e.Yj().optional(),lastUpdated:e.p6()});class g{constructor(){this.contextStore=new Map,this.sessionContexts=new Map,this.contextIndices={bySession:new Map,byAgent:new Map,byType:new Map,byTags:new Map},this.startContextCleanup()}async storeContext(a){try{let b={...a,id:crypto.randomUUID(),timestamp:new Date},c=f.parse(b);return this.contextStore.set(c.id,c),this.updateIndices(c),await this.updateSessionContext(c),(0,d.fH)(`ðŸ“ Context stored: ${c.contextType}/${c.key} for ${c.agentId}`),c.id}catch(a){throw(0,d.vV)("Error storing context:",a),a}}async getContext(a){try{let b=new Set(this.contextStore.keys());if(a.sessionId){let c=this.contextIndices.bySession.get(a.sessionId)||new Set;b=new Set([...b].filter(a=>c.has(a)))}if(a.agentId){let c=this.contextIndices.byAgent.get(a.agentId)||new Set;b=new Set([...b].filter(a=>c.has(a)))}if(a.contextType?.length){let c=new Set;a.contextType.forEach(a=>{(this.contextIndices.byType.get(a)||new Set).forEach(a=>c.add(a))}),b=new Set([...b].filter(a=>c.has(a)))}if(a.tags?.length){let c=new Set;a.tags.forEach(a=>{(this.contextIndices.byTags.get(a)||new Set).forEach(a=>c.add(a))}),b=new Set([...b].filter(a=>c.has(a)))}let c=[];for(let d of b){let b=this.contextStore.get(d);if(b){if(a.timeRange){let c=b.timestamp.getTime();if(c<a.timeRange.start.getTime()||c>a.timeRange.end.getTime())continue}!(a.keys?.length&&!a.keys.includes(b.key)||a.priority?.length&&!a.priority.includes(b.priority))&&(b.expiresAt&&b.expiresAt<new Date||c.push(b))}}return c.sort((a,b)=>{let c={critical:4,high:3,medium:2,low:1},d=c[a.priority],e=c[b.priority];return d!==e?e-d:b.timestamp.getTime()-a.timestamp.getTime()}),a.limit&&a.limit>0&&(c=c.slice(0,a.limit)),c}catch(a){throw(0,d.vV)("Error retrieving context:",a),a}}async getConversationContext(a){return this.sessionContexts.get(a)||null}async updateConversationContext(a,b){try{let c=this.sessionContexts.get(a);if(c){let d={...c,...b,lastUpdated:new Date};this.sessionContexts.set(a,d)}else{let c={sessionId:a,participants:b.participants||[],conversationHistory:b.conversationHistory||[],sharedKnowledge:b.sharedKnowledge||{},activeGoals:b.activeGoals||[],lastUpdated:new Date,...b};this.sessionContexts.set(a,c)}(0,d.fH)(`ðŸ”„ Conversation context updated for session ${a}`)}catch(a){throw(0,d.vV)("Error updating conversation context:",a),a}}async addToConversationHistory(a,b,c,e,f="medium"){try{let d=this.sessionContexts.get(a);d||(d={sessionId:a,participants:[c],conversationHistory:[],sharedKnowledge:{},activeGoals:[],lastUpdated:new Date}),d.conversationHistory.push({messageId:b,agentId:c,content:e,timestamp:new Date,importance:f}),d.conversationHistory.length>100&&(d.conversationHistory=d.conversationHistory.slice(-100)),d.participants.includes(c)||d.participants.push(c),d.lastUpdated=new Date,this.sessionContexts.set(a,d)}catch(a){throw(0,d.vV)("Error adding to conversation history:",a),a}}async storeSharedKnowledge(a,b,c,e){try{await this.storeContext({sessionId:a,agentId:e||"system",contextType:"knowledge",key:b,value:c,priority:"medium",tags:["shared-knowledge"]});let f=this.sessionContexts.get(a);f||(f={sessionId:a,participants:e?[e]:[],conversationHistory:[],sharedKnowledge:{},activeGoals:[],lastUpdated:new Date}),f.sharedKnowledge[b]=c,f.lastUpdated=new Date,this.sessionContexts.set(a,f),(0,d.fH)(`ðŸ§  Shared knowledge stored: ${b} for session ${a}`)}catch(a){throw(0,d.vV)("Error storing shared knowledge:",a),a}}async getSharedKnowledge(a,b){let c=this.sessionContexts.get(a);return c?b?c.sharedKnowledge[b]:c.sharedKnowledge:b?void 0:{}}async updateGoal(a,b){try{let c=this.sessionContexts.get(a);c||(c={sessionId:a,participants:[],conversationHistory:[],sharedKnowledge:{},activeGoals:[],lastUpdated:new Date});let e=c.activeGoals.findIndex(a=>a.id===b.id);-1!==e?c.activeGoals[e]={...b,priority:b.priority||"medium"}:c.activeGoals.push({...b,priority:b.priority||"medium"}),c.lastUpdated=new Date,this.sessionContexts.set(a,c),await this.storeContext({sessionId:a,agentId:b.assignedAgent||"system",contextType:"task",key:`goal-${b.id}`,value:b,priority:"high"===b.priority?"high":"medium",tags:["goal",b.status]}),(0,d.fH)(`ðŸŽ¯ Goal updated: ${b.id} (${b.status}) for session ${a}`)}catch(a){throw(0,d.vV)("Error updating goal:",a),a}}async generateContextSummary(a){try{let b=this.sessionContexts.get(a),c=await this.getContext({sessionId:a,limit:1e3});if(!b)return{sessionId:a,totalEntries:c.length,activeAgents:[],mainTopics:[],recentActivity:new Date,keyInsights:[],completedGoals:0,pendingGoals:0};let d=new Set,e=new Map,f=[];c.forEach(a=>{d.add(a.agentId),a.tags.forEach(a=>{e.set(a,(e.get(a)||0)+1)}),("high"===a.priority||"critical"===a.priority)&&"string"==typeof a.value&&f.push(a.value)});let g=Array.from(e.entries()).sort((a,b)=>b[1]-a[1]).slice(0,5).map(([a])=>a),h=b.activeGoals.filter(a=>"completed"===a.status).length,i=b.activeGoals.filter(a=>"completed"!==a.status).length;return{sessionId:a,totalEntries:c.length,activeAgents:Array.from(d),mainTopics:g,recentActivity:b.lastUpdated,keyInsights:f.slice(0,10),completedGoals:h,pendingGoals:i}}catch(a){throw(0,d.vV)("Error generating context summary:",a),a}}async clearExpiredContext(){try{let a=new Date,b=0;for(let[c,d]of this.contextStore.entries())d.expiresAt&&d.expiresAt<a&&(this.contextStore.delete(c),this.removeFromIndices(d),b++);return b>0&&(0,d.fH)(`ðŸ§¹ Cleared ${b} expired context entries`),b}catch(a){return(0,d.vV)("Error clearing expired context:",a),0}}async exportSessionContext(a){return{conversationContext:this.sessionContexts.get(a)||null,contextEntries:await this.getContext({sessionId:a})}}async importSessionContext(a){try{for(let b of(this.sessionContexts.set(a.conversationContext.sessionId,a.conversationContext),a.contextEntries))this.contextStore.set(b.id,b),this.updateIndices(b);(0,d.fH)(`ðŸ“¥ Imported context for session ${a.conversationContext.sessionId}`)}catch(a){throw(0,d.vV)("Error importing session context:",a),a}}updateIndices(a){this.contextIndices.bySession.has(a.sessionId)||this.contextIndices.bySession.set(a.sessionId,new Set),this.contextIndices.bySession.get(a.sessionId).add(a.id),this.contextIndices.byAgent.has(a.agentId)||this.contextIndices.byAgent.set(a.agentId,new Set),this.contextIndices.byAgent.get(a.agentId).add(a.id),this.contextIndices.byType.has(a.contextType)||this.contextIndices.byType.set(a.contextType,new Set),this.contextIndices.byType.get(a.contextType).add(a.id),a.tags.forEach(b=>{this.contextIndices.byTags.has(b)||this.contextIndices.byTags.set(b,new Set),this.contextIndices.byTags.get(b).add(a.id)})}removeFromIndices(a){this.contextIndices.bySession.get(a.sessionId)?.delete(a.id),this.contextIndices.byAgent.get(a.agentId)?.delete(a.id),this.contextIndices.byType.get(a.contextType)?.delete(a.id),a.tags.forEach(b=>{this.contextIndices.byTags.get(b)?.delete(a.id)})}async updateSessionContext(a){}startContextCleanup(){setInterval(()=>{this.clearExpiredContext().catch(console.error)},3e5)}getContextStats(){return{totalEntries:this.contextStore.size,activeSessions:this.sessionContexts.size,memoryUsage:{contextStore:this.contextStore.size,sessionContexts:this.sessionContexts.size,indices:Object.values(this.contextIndices).reduce((a,b)=>a+b.size,0)}}}destroy(){this.contextStore.clear(),this.sessionContexts.clear(),Object.values(this.contextIndices).forEach(a=>a.clear())}}},69650:(a,b,c)=>{"use strict";c.d(b,{hW:()=>i});var d=c(30477),e=c(2995),f=c(10154),g=c(43008);let h=e.Ik({id:e.Yj().uuid(),sessionId:e.Yj().uuid(),fromAgent:e.Yj(),toAgent:e.Yj().nullable(),messageType:e.k5(["request","response","notification","handoff","broadcast"]),content:e.Yj(),context:e.g1(e.bz()).optional(),priority:e.k5(["low","medium","high","urgent"]).default("medium"),threadId:e.Yj().uuid().optional(),parentMessageId:e.Yj().uuid().optional(),timestamp:e.p6(),metadata:e.g1(e.bz()).optional()});e.Ik({id:e.Yj().uuid(),userId:e.ai(),projectName:e.Yj().optional(),participatingAgents:e.YO(e.Yj()),sessionStatus:e.k5(["active","paused","completed","cancelled"]).default("active"),sessionType:e.k5(["chat","project","handoff","consultation"]).default("chat"),createdAt:e.p6(),updatedAt:e.p6(),completedAt:e.p6().optional(),metadata:e.g1(e.bz()).optional()}),e.Ik({id:e.Yj(),name:e.Yj(),displayName:e.Yj(),description:e.Yj(),capabilities:e.YO(e.Yj()),specializations:e.YO(e.Yj()),personality:e.Yj(),accentColor:e.Yj(),status:e.k5(["available","busy","offline"]).default("available"),currentSessions:e.YO(e.Yj()).default([]),maxConcurrentSessions:e.ai().default(5),responseTimeMs:e.ai().default(2e3)});class i{constructor(){this.agents=new Map,this.activeSessions=new Map,this.eventListeners=new Map,this.messageRouter=new f.$(this),this.contextManager=new g.vE,this.initializeAgents()}initializeAgents(){let a=[{id:"roxy",name:"roxy",displayName:"Roxy",description:"Strategic Decision Architect & Executive Assistant",capabilities:["SPADE Framework","Strategic Planning","Schedule Management","Risk Assessment"],specializations:["executive-assistance","strategic-planning","decision-making"],personality:"Efficiently rebellious, organized chaos master, proactively punk",accentColor:"#8B5CF6",status:"available",currentSessions:[],maxConcurrentSessions:10,responseTimeMs:1500},{id:"blaze",name:"blaze",displayName:"Blaze",description:"Growth & Sales Strategist",capabilities:["Cost-Benefit Analysis","Sales Funnels","Market Strategy","Growth Planning"],specializations:["growth-strategy","sales","market-analysis"],personality:"Energetically rebellious, results-driven with punk rock passion",accentColor:"#F59E0B",status:"available",currentSessions:[],maxConcurrentSessions:8,responseTimeMs:1800},{id:"echo",name:"echo",displayName:"Echo",description:"Marketing Maven & Content Creator",capabilities:["Content Creation","Brand Strategy","Social Media","Campaign Planning"],specializations:["marketing","content-creation","branding"],personality:"Creatively rebellious, high-converting with warm punk energy",accentColor:"#EC4899",status:"available",currentSessions:[],maxConcurrentSessions:6,responseTimeMs:2e3},{id:"lumi",name:"lumi",displayName:"Lumi",description:"Guardian AI & Compliance Co-Pilot",capabilities:["GDPR/CCPA Compliance","Policy Generation","Legal Guidance","Risk Management"],specializations:["compliance","legal","risk-management"],personality:"Proactive compliance expert with ethical decision-making",accentColor:"#10B981",status:"available",currentSessions:[],maxConcurrentSessions:5,responseTimeMs:2500},{id:"vex",name:"vex",displayName:"Vex",description:"Technical Architect & Systems Optimizer",capabilities:["System Design","Automation","Technical Strategy","Process Optimization"],specializations:["technical-architecture","automation","systems"],personality:"Systems rebel, automation architect, technical problem solver",accentColor:"#3B82F6",status:"available",currentSessions:[],maxConcurrentSessions:4,responseTimeMs:3e3},{id:"lexi",name:"lexi",displayName:"Lexi",description:"Strategy Analyst & Data Queen",capabilities:["Data Analysis","Market Research","Performance Metrics","Strategic Insights"],specializations:["data-analysis","research","analytics"],personality:"Data-driven insights insurgent, analytical powerhouse",accentColor:"#6366F1",status:"available",currentSessions:[],maxConcurrentSessions:6,responseTimeMs:2200},{id:"nova",name:"nova",displayName:"Nova",description:"Productivity & Time Management Coach",capabilities:["Time Management","Workflow Optimization","Productivity Systems","Focus Techniques"],specializations:["productivity","time-management","workflows"],personality:"Productivity revolutionary, time optimization expert",accentColor:"#06B6D4",status:"available",currentSessions:[],maxConcurrentSessions:8,responseTimeMs:1600},{id:"glitch",name:"glitch",displayName:"Glitch",description:"Problem-Solving Architect",capabilities:["Five Whys Analysis","Problem Solving","Innovation","Creative Solutions"],specializations:["problem-solving","root-cause-analysis","innovation"],personality:"Root cause investigator, creative problem solver",accentColor:"#EF4444",status:"available",currentSessions:[],maxConcurrentSessions:7,responseTimeMs:1900}];a.forEach(a=>{this.agents.set(a.id,a)}),(0,d.fH)(`âœ… Collaboration Hub initialized with ${a.length} agents`)}async initiateCollaboration(a){try{let b=crypto.randomUUID(),c=await this.selectAgentsForCollaboration(a);if(0===c.length)return{sessionId:"",participants:[],status:"error",message:"No suitable agents available for collaboration"};let d={id:b,userId:a.userId,projectName:a.projectName,participatingAgents:c.map(a=>a.id),sessionStatus:"active",sessionType:a.requestType,createdAt:new Date,updatedAt:new Date,metadata:{priority:a.priority||"medium",context:a.context||{}}};if(this.activeSessions.set(b,d),c.forEach(a=>{a.currentSessions.push(b),a.currentSessions.length>=a.maxConcurrentSessions&&(a.status="busy")}),a.initialMessage){let d={sessionId:b,fromAgent:"user",toAgent:a.primaryAgent||c[0].id,messageType:"request",content:a.initialMessage,context:a.context,priority:a.priority||"medium"};await this.routeMessage({...d,id:crypto.randomUUID(),timestamp:new Date})}return this.emitEvent("session_created",{sessionId:b,participants:c.length}),{sessionId:b,participants:c,status:"created"}}catch(a){return(0,d.vV)("Error initiating collaboration:",a),{sessionId:"",participants:[],status:"error",message:a instanceof Error?a.message:"Unknown error occurred"}}}async routeMessage(a){try{let b=h.parse(a),c=this.activeSessions.get(b.sessionId);if(!c)throw Error(`Session ${b.sessionId} not found`);await this.messageRouter.routeMessage(b),c.updatedAt=new Date,this.activeSessions.set(c.id,c),this.emitEvent("message_routed",{sessionId:b.sessionId,messageType:b.messageType})}catch(a){throw(0,d.vV)("Error routing message:",a),a}}getSession(a){return this.activeSessions.get(a)||null}getUserSessions(a){return Array.from(this.activeSessions.values()).filter(b=>b.userId===a&&"active"===b.sessionStatus)}getAgent(a){return this.agents.get(a)||null}getAvailableAgents(){return Array.from(this.agents.values()).filter(a=>"available"===a.status)}async completeSession(a,b){try{let c=this.activeSessions.get(a);if(!c)return!1;return c.sessionStatus="completed",c.completedAt=new Date,c.updatedAt=new Date,b&&(c.metadata={...c.metadata,completionReason:b}),c.participatingAgents.forEach(b=>{let c=this.agents.get(b);c&&(c.currentSessions=c.currentSessions.filter(b=>b!==a),c.currentSessions.length<c.maxConcurrentSessions&&(c.status="available"))}),this.activeSessions.set(a,c),this.emitEvent("session_completed",{sessionId:a,reason:b}),!0}catch(a){return(0,d.vV)("Error completing session:",a),!1}}async selectAgentsForCollaboration(a){let b=[];if(a.requiredAgents?.length)for(let c of a.requiredAgents){let a=this.agents.get(c);a&&"available"===a.status&&b.push(a)}if(a.primaryAgent){let c=this.agents.get(a.primaryAgent);c&&"available"===c.status&&!b.find(a=>a.id===c.id)&&b.unshift(c)}if("project"===a.requestType&&b.length<3){let a=this.getAvailableAgents().filter(a=>!b.find(b=>b.id===a.id)).sort((a,b)=>a.currentSessions.length-b.currentSessions.length);for(let c of this.getComplementarySpecializations(b.flatMap(a=>a.specializations))){let d=a.find(a=>a.specializations.includes(c));d&&b.length<4&&b.push(d)}}if(0===b.length){let a=this.getAvailableAgents();if(a.length>0){let c=a.find(a=>"roxy"===a.id)||a[0];b.push(c)}}return b}getComplementarySpecializations(a){return["strategic-planning","growth-strategy","marketing","technical-architecture","data-analysis","compliance","productivity","problem-solving"].filter(b=>!a.includes(b))}on(a,b){this.eventListeners.has(a)||this.eventListeners.set(a,[]),this.eventListeners.get(a).push(b)}emitEvent(a,b){(this.eventListeners.get(a)||[]).forEach(c=>{try{c(b)}catch(b){(0,d.vV)(`Error in event listener for ${a}:`,b)}})}getStats(){let a=Array.from(this.agents.values()).filter(a=>"available"===a.status).length,b=Array.from(this.activeSessions.values()).filter(a=>"active"===a.sessionStatus).length;return{totalAgents:this.agents.size,availableAgents:a,activeSessions:b,totalMessages:0}}}new i},74291:(a,b,c)=>{"use strict";c.d(b,{_:()=>m,authenticateRequest:()=>l});var d=c(30477);c(10641);var e=c(86802),f=c(80829),g=c.n(f),h=c(94570),i=c(41393),j=c(48689);async function k(){try{let a=await (0,e.b3)(),b=a.get("authorization"),c=null;if(b&&b.startsWith("Bearer "))c=b.substring(7);else{let b=a.get("cookie");b&&(c=b.split(";").reduce((a,b)=>{let[c,d]=b.trim().split("=");return a[c]=d,a},{}).auth_token||null)}if(!c)return null;let d=g().verify(c,"local-development-jwt-secret-key");if(!d||!d.userId)return null;let f=(0,h.Lf)(),k=await f.select({id:i.users.id,email:i.users.email,full_name:i.users.full_name,username:i.users.username,date_of_birth:i.users.date_of_birth,created_at:i.users.created_at,updated_at:i.users.updated_at,subscription_tier:i.users.subscription_tier,subscription_status:i.users.subscription_status}).from(i.users).where((0,j.eq)(i.users.id,d.userId)).limit(1);if(0===k.length)return null;let l=k[0];return{id:l.id,email:l.email,full_name:l.full_name,name:l.full_name,username:l.username,created_at:l.created_at,updated_at:l.updated_at,subscription_tier:l.subscription_tier??"free",subscription_status:l.subscription_status??"active"}}catch(a){return(0,d.vV)("JWT authentication error:",a),null}}async function l(){try{let a=await k();if(a)return{user:a,error:null};return{user:null,error:"No authenticated user session found"}}catch(a){return(0,d.vV)("Authentication error:",a),{user:null,error:"Authentication failed"}}}async function m(a){try{let a=await l();return{user:a.user||void 0,error:a.error||void 0}}catch(a){return(0,d.vV)("verifyAuth error:",a),{error:"Authentication failed"}}}},78335:()=>{},96487:()=>{}};