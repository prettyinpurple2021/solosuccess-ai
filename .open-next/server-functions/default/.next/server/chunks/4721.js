"use strict";exports.id=4721,exports.ids=[4721],exports.modules={74721:(a,b,c)=>{c.d(b,{e:()=>i});var d=c(97356),e=c(41393),f=c(48689),g=c(71559);class h{async analyzeEngagementPatterns(a,b,c=30){let d=new Date;d.setDate(d.getDate()-c);let e=await this.getSocialMediaData(a,b,d),f=[];for(let[b,c]of Object.entries(this.groupDataByPlatform(e))){let d=this.extractPostsFromData(c);if(0===d.length)continue;let e={platform:b,competitorId:a,patterns:{timeOfDay:this.analyzeTimeOfDayPatterns(d),dayOfWeek:this.analyzeDayOfWeekPatterns(d),contentType:this.analyzeContentTypePatterns(d),hashtagPerformance:this.analyzeHashtagPatterns(d)},insights:[],recommendations:[],analyzedAt:new Date};e.insights=this.generateEngagementInsights(e.patterns),e.recommendations=this.generateEngagementRecommendations(e.patterns),f.push(e)}return f}async analyzePostingFrequency(a,b,c=30){let d=new Date;d.setDate(d.getDate()-c);let e=await this.getSocialMediaData(a,b,d),f=[];for(let[b,d]of Object.entries(this.groupDataByPlatform(e))){let e=this.extractPostsFromData(d);if(0===e.length)continue;let g={platform:b,competitorId:a,frequency:this.calculateFrequencyMetrics(e,c),consistency:this.analyzePostingConsistency(e),optimalTiming:this.identifyOptimalTiming(e),insights:[],recommendations:[],analyzedAt:new Date};g.insights=this.generateFrequencyInsights(g),g.recommendations=this.generateFrequencyRecommendations(g),f.push(g)}return f}async analyzeAudience(a,b,c=30){let d=new Date;d.setDate(d.getDate()-c);let e=await this.getSocialMediaData(a,b,d),f=[];for(let[b,c]of Object.entries(this.groupDataByPlatform(e))){let d=this.extractPostsFromData(c);if(0===d.length)continue;let e={platform:b,competitorId:a,engagement:this.analyzeEngagementMetrics(d),demographics:this.estimateDemographics(d),behavior:this.analyzeAudienceBehavior(d),growth:this.analyzeGrowthMetrics(d,c),insights:[],recommendations:[],analyzedAt:new Date};e.insights=this.generateAudienceInsights(e),e.recommendations=this.generateAudienceRecommendations(e),f.push(e)}return f}async analyzeCampaigns(a,b,c=90){let d=new Date;d.setDate(d.getDate()-c);let e=await this.getSocialMediaData(a,b,d),f=[];for(let[b,c]of Object.entries(this.groupDataByPlatform(e))){let d=this.extractPostsFromData(c);if(0===d.length)continue;let e=this.detectCampaigns(d),g=this.analyzeCampaignTypes(e),h=this.calculateCampaignPerformance(e),i={platform:b,competitorId:a,campaigns:e,campaignTypes:g,performance:h,insights:this.generateCampaignInsights(e,h),recommendations:this.generateCampaignRecommendations(e,h),analyzedAt:new Date};f.push(i)}return f}async createCompetitiveBenchmarks(a,b,c=30){let d=[];for(let e of a){let f=new Date;f.setDate(f.getDate()-c);let g=await this.getSocialMediaData(e,b,f);for(let[b,f]of Object.entries(this.groupDataByPlatform(g))){let g=this.extractPostsFromData(f);if(0===g.length)continue;let h=this.calculateBenchmarkMetrics(g),i=await this.createCompetitorComparisons(e,a.filter(a=>a!==e),b,c),j={competitorId:e,platform:b,benchmarks:h,positioning:this.calculateMarketPositioning(h,i),comparison:i,insights:this.generateBenchmarkInsights(h,i),recommendations:this.generateBenchmarkRecommendations(h,i),analyzedAt:new Date};d.push(j)}}return d}async getSocialMediaData(a,b,c){let h=(0,f.Uo)((0,f.eq)(e.intelligenceData.competitor_id,a),(0,f.eq)(e.intelligenceData.source_type,"social_media"));return b&&(h=(0,f.Uo)(h,(0,f.eq)(e.intelligenceData.data_type,`${b}_analysis`))),c&&(h=(0,f.Uo)(h,(0,f.RO)(e.intelligenceData.collected_at,c))),await d.db.select().from(e.intelligenceData).where(h).orderBy((0,g.i)(e.intelligenceData.collected_at))}groupDataByPlatform(a){let b={};return a.forEach(a=>{let c=a.data_type?.replace("_analysis","")||"unknown";b[c]||(b[c]=[]),b[c].push(a)}),b}extractPostsFromData(a){let b=[];return a.forEach(a=>{let c=a.raw_content;Array.isArray(c)&&b.push(...c)}),b.sort((a,b)=>new Date(b.publishedAt).getTime()-new Date(a.publishedAt).getTime())}analyzeTimeOfDayPatterns(a){let b={};return a.forEach(a=>{let c=new Date(a.publishedAt).getHours(),d=this.calculateTotalEngagement(a.engagement);b[c]||(b[c]={engagement:0,count:0,content:[]}),b[c].engagement+=d,b[c].count+=1,b[c].content.push(a.content.substring(0,100))}),Object.entries(b).map(([a,b])=>({hour:parseInt(a),avgEngagement:b.engagement/b.count,postCount:b.count,engagementRate:b.engagement/(1e3*b.count),bestContent:b.content.slice(0,3)})).sort((a,b)=>b.avgEngagement-a.avgEngagement)}analyzeDayOfWeekPatterns(a){let b={};return a.forEach(a=>{let c=new Date(a.publishedAt),d=c.toLocaleDateString("en-US",{weekday:"long"}),e=c.getHours(),f=this.calculateTotalEngagement(a.engagement);b[d]||(b[d]={engagement:0,count:0,hours:[]}),b[d].engagement+=f,b[d].count+=1,b[d].hours.push(e)}),Object.entries(b).map(([a,b])=>{let c={};b.hours.forEach(a=>{c[a]=(c[a]||0)+1});let d=Object.entries(c).sort((a,b)=>b[1]-a[1]).slice(0,3).map(([a])=>parseInt(a));return{day:a,avgEngagement:b.engagement/b.count,postCount:b.count,engagementRate:b.engagement/(1e3*b.count),peakHours:d}}).sort((a,b)=>b.avgEngagement-a.avgEngagement)}analyzeContentTypePatterns(a){let b={};return a.forEach(a=>{let c=this.detectContentType(a),d=this.calculateTotalEngagement(a.engagement);b[c]||(b[c]={count:0,engagement:0,examples:[]}),b[c].count+=1,b[c].engagement+=d,b[c].examples.push(a.content.substring(0,100))}),Object.entries(b).map(([a,b])=>({type:a,count:b.count,avgEngagement:b.engagement/b.count,engagementRate:b.engagement/(1e3*b.count),examples:b.examples.slice(0,3)})).sort((a,b)=>b.avgEngagement-a.avgEngagement)}analyzeHashtagPatterns(a){let b={};return a.forEach(a=>{let c=this.calculateTotalEngagement(a.engagement),d=a.hashtags||[];d.forEach(a=>{b[a]||(b[a]={usage:0,engagement:0,related:new Set}),b[a].usage+=1,b[a].engagement+=c,d.forEach(c=>{c!==a&&b[a].related.add(c)})})}),Object.entries(b).filter(([a,b])=>b.usage>=2).map(([b,c])=>({hashtag:b,usage:c.usage,avgEngagement:c.engagement/c.usage,engagementBoost:this.calculateEngagementBoost(b,a),relatedHashtags:Array.from(c.related).slice(0,5)})).sort((a,b)=>b.avgEngagement-a.avgEngagement)}calculateFrequencyMetrics(a,b){let c=this.groupPostsByDay(a),d=this.groupPostsByWeek(a),e=this.groupPostsByMonth(a);return{daily:this.calculateFrequencyStats(Object.values(c)),weekly:this.calculateFrequencyStats(Object.values(d)),monthly:this.calculateFrequencyStats(Object.values(e))}}analyzePostingConsistency(a){let b,c=this.groupPostsByDay(a),d=Object.keys(c).sort(),e=this.findPostingGaps(d),f=this.calculatePostingVariance(Object.values(c)),g=Math.max(0,100-10*e.length-20*f);return b=g>80?"regular":g>60?"irregular":g>30?"sporadic":"burst",{score:Math.round(g),pattern:b,gaps:e.map(a=>({start:new Date(a.start),end:new Date(a.end),duration:a.duration,possibleReason:this.inferGapReason(a.duration)}))}}identifyOptimalTiming(a){let b={},c={};a.forEach(a=>{let d=new Date(a.publishedAt),e=d.toLocaleDateString("en-US",{weekday:"long"}),f=d.getHours(),g=this.calculateTotalEngagement(a.engagement);b[e]=(b[e]||0)+g,c[f]=(c[f]||0)+g});let d=Object.entries(b).sort((a,b)=>b[1]-a[1]),e=Object.entries(c).sort((a,b)=>b[1]-a[1]);return{bestDays:d.slice(0,3).map(([a])=>a),bestHours:e.slice(0,3).map(([a])=>parseInt(a)),worstDays:d.slice(-2).map(([a])=>a),worstHours:e.slice(-2).map(([a])=>parseInt(a))}}calculateTotalEngagement(a){return(a.likes||0)+(a.shares||0)+(a.comments||0)}detectContentType(a){if(a.mediaUrls&&a.mediaUrls.length>0){if(a.mediaUrls.length>1)return"carousel";let b=a.mediaUrls[0];if(b.includes("video")||b.includes(".mp4"))return"video";if(b.includes("image")||b.includes(".jpg")||b.includes(".png"))return"image"}return a.content.includes("http")?"link":"text"}calculateEngagementBoost(a,b){let c=b.filter(b=>b.hashtags?.includes(a)),d=b.filter(b=>!b.hashtags?.includes(a));if(0===d.length)return 0;let e=c.reduce((a,b)=>a+this.calculateTotalEngagement(b.engagement),0)/c.length,f=d.reduce((a,b)=>a+this.calculateTotalEngagement(b.engagement),0)/d.length;return(e-f)/f*100}groupPostsByDay(a){let b={};return a.forEach(a=>{let c=new Date(a.publishedAt).toISOString().split("T")[0];b[c]||(b[c]=[]),b[c].push(a)}),b}groupPostsByWeek(a){let b={};return a.forEach(a=>{let c=new Date(a.publishedAt),d=new Date(c.setDate(c.getDate()-c.getDay())).toISOString().split("T")[0];b[d]||(b[d]=[]),b[d].push(a)}),b}groupPostsByMonth(a){let b={};return a.forEach(a=>{let c=new Date(a.publishedAt),d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`;b[d]||(b[d]=[]),b[d].push(a)}),b}calculateFrequencyStats(a){let b=a.map(a=>a.length);return{average:b.reduce((a,b)=>a+b,0)/b.length,min:Math.min(...b),max:Math.max(...b),trend:this.calculateTrend(b)}}calculateTrend(a){if(a.length<2)return"stable";let b=a.slice(0,Math.floor(a.length/2)),c=a.slice(Math.floor(a.length/2)),d=b.reduce((a,b)=>a+b,0)/b.length,e=(c.reduce((a,b)=>a+b,0)/c.length-d)/d;return e>.1?"increasing":e<-.1?"decreasing":"stable"}findPostingGaps(a){let b=[];for(let c=1;c<a.length;c++){let d=new Date(a[c-1]),e=Math.floor((new Date(a[c]).getTime()-d.getTime())/864e5);e>3&&b.push({start:a[c-1],end:a[c],duration:e})}return b}calculatePostingVariance(a){let b=a.map(a=>a.length),c=b.reduce((a,b)=>a+b,0)/b.length;return Math.sqrt(b.reduce((a,b)=>a+Math.pow(b-c,2),0)/b.length)/c}inferGapReason(a){return a>=7&&a<=14?"Possible vacation or break":a>=15&&a<=30?"Possible strategic pause or campaign preparation":a>30?"Possible platform strategy change or resource constraints":"Short break or irregular posting"}generateEngagementInsights(a){let b=[],c=a.timeOfDay[0];c&&b.push(`Peak engagement occurs at ${c.hour}:00 with ${c.avgEngagement.toFixed(0)} average interactions`);let d=a.dayOfWeek[0];d&&b.push(`${d.day} is the most engaging day with ${d.avgEngagement.toFixed(0)} average interactions`);let e=a.contentType[0];if(e&&b.push(`${e.type} content performs best with ${e.avgEngagement.toFixed(0)} average engagement`),a.hashtagPerformance.length>0){let c=a.hashtagPerformance[0];b.push(`Top performing hashtag "${c.hashtag}" boosts engagement by ${c.engagementBoost.toFixed(1)}%`)}return b}generateEngagementRecommendations(a){let b=[],c=a.timeOfDay[0],d=a.dayOfWeek[0];c&&d&&b.push(`Schedule posts on ${d.day} at ${c.hour}:00 for maximum engagement`);let e=a.contentType[0];e&&"text"!==e.type&&b.push(`Focus on ${e.type} content to increase engagement by up to ${((e.avgEngagement/a.contentType[a.contentType.length-1].avgEngagement-1)*100).toFixed(0)}%`);let f=a.hashtagPerformance.slice(0,3);return f.length>0&&b.push(`Use hashtags like ${f.map(a=>a.hashtag).join(", ")} to boost engagement`),b}generateFrequencyInsights(a){let b=[];return b.push(`Posts ${a.frequency.daily.average.toFixed(1)} times per day on average`),b.push(`Posting consistency score: ${a.consistency.score}/100 (${a.consistency.pattern})`),a.optimalTiming.bestDays.length>0&&b.push(`Most effective posting days: ${a.optimalTiming.bestDays.join(", ")}`),a.consistency.gaps.length>0&&b.push(`${a.consistency.gaps.length} significant posting gaps detected`),b}generateFrequencyRecommendations(a){let b=[];return a.consistency.score<70&&b.push("Improve posting consistency to build better audience engagement"),a.frequency.daily.average<.5?b.push("Consider increasing posting frequency to maintain audience attention"):a.frequency.daily.average>3&&b.push("Consider reducing posting frequency to avoid audience fatigue"),b.push(`Focus posting on ${a.optimalTiming.bestDays.join(" and ")} for better performance`),b}analyzeEngagementMetrics(a){return{totalReach:0,avgEngagementRate:0,engagementTrend:"stable",topEngagers:[]}}estimateDemographics(a){return{estimatedAgeGroups:{},estimatedGender:{},estimatedLocations:{},professionalBackground:[]}}analyzeAudienceBehavior(a){return{peakActivityTimes:[],contentPreferences:[],interactionTypes:{},loyaltyScore:0}}analyzeGrowthMetrics(a,b){return{followerGrowthRate:0,engagementGrowthRate:0,contentGrowthRate:0}}generateAudienceInsights(a){return[]}generateAudienceRecommendations(a){return[]}detectCampaigns(a){return[]}analyzeCampaignTypes(a){return[]}calculateCampaignPerformance(a){return{totalCampaigns:0,avgCampaignDuration:0,avgCampaignEngagement:0,mostSuccessfulType:"",leastSuccessfulType:"",seasonalTrends:{}}}generateCampaignInsights(a,b){return[]}generateCampaignRecommendations(a,b){return[]}calculateBenchmarkMetrics(a){return{engagement:{value:0,percentile:0,industryAverage:0,trend:"unknown"},frequency:{value:0,percentile:0,industryAverage:0,trend:"unknown"},reach:{value:0,percentile:0,industryAverage:0,trend:"unknown"},sentiment:{value:0,percentile:0,industryAverage:0,trend:"unknown"}}}async createCompetitorComparisons(a,b,c,d){return[]}calculateMarketPositioning(a,b){return{rank:0,totalCompetitors:0,strengths:[],weaknesses:[],opportunities:[]}}generateBenchmarkInsights(a,b){return[]}generateBenchmarkRecommendations(a,b){return[]}}let i=new h}};