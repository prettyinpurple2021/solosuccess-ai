"use strict";exports.id=5243,exports.ids=[5243],exports.modules={75243:(a,b,c)=>{c.r(b),c.d(b,{CompetitorEnrichmentService:()=>g,competitorEnrichmentService:()=>h});let d={enableWebScraping:!0,enableSocialMediaDiscovery:!0,enablePersonnelMapping:!0,enableThreatAssessment:!0,respectRateLimit:!0,maxRetries:3},e={linkedin:/^https?:\/\/(www\.)?linkedin\.com\/(company|in)\/[a-zA-Z0-9-_]+\/?$/,twitter:/^https?:\/\/(www\.)?(twitter\.com|x\.com)\/[a-zA-Z0-9_]+\/?$/,facebook:/^https?:\/\/(www\.)?facebook\.com\/[a-zA-Z0-9.-]+\/?$/,instagram:/^https?:\/\/(www\.)?instagram\.com\/[a-zA-Z0-9_.]+\/?$/,youtube:/^https?:\/\/(www\.)?youtube\.com\/(channel|c|user)\/[a-zA-Z0-9_-]+\/?$/},f={technology:["software","saas","tech","digital","ai","ml","cloud","platform"],finance:["fintech","banking","payment","financial","investment","trading"],healthcare:["health","medical","pharma","biotech","telemedicine","wellness"],ecommerce:["ecommerce","retail","marketplace","shopping","commerce"],education:["edtech","education","learning","training","academic"],marketing:["martech","advertising","marketing","analytics","crm"]};class g{constructor(a={}){this.rateLimitTracker=new Map,this.config={...d,...a}}async enrichCompetitorProfile(a,b){let c={success:!1,confidence:0,sources:[],errors:[],warnings:[]};try{let d={},e=0,f=0;if(this.config.enableWebScraping&&a.domain)try{let b=await this.extractCompanyInfoFromWebsite(a.domain);b.success?(Object.assign(d,b.data),e+=b.confidence,f++,c.sources.push("company_website")):c.warnings.push(`Website extraction failed: ${b.errors.join(", ")}`)}catch(a){c.warnings.push(`Website extraction error: ${a instanceof Error?a.message:"Unknown error"}`)}if(this.config.enableSocialMediaDiscovery)try{let b=await this.discoverSocialMediaHandles(a.name||"",a.domain);b.success?(d.socialMediaHandles={...d.socialMediaHandles,...b.data?.socialMediaHandles},e+=b.confidence,f++,c.sources.push("social_media_discovery")):c.warnings.push(`Social media discovery failed: ${b.errors.join(", ")}`)}catch(a){c.warnings.push(`Social media discovery error: ${a instanceof Error?a.message:"Unknown error"}`)}if(this.config.enablePersonnelMapping&&a.domain)try{let b=await this.identifyKeyPersonnel(a.name||"",a.domain);b.success?(d.keyPersonnel=[...d.keyPersonnel||[],...b.data?.keyPersonnel||[]],e+=b.confidence,f++,c.sources.push("personnel_mapping")):c.warnings.push(`Personnel mapping failed: ${b.errors.join(", ")}`)}catch(a){c.warnings.push(`Personnel mapping error: ${a instanceof Error?a.message:"Unknown error"}`)}if(this.config.enableThreatAssessment)try{let g=await this.assessThreatLevel({...a,...d},b);g.success?(d.threatLevel=g.data?.threatLevel,d.competitiveAdvantages=[...d.competitiveAdvantages||[],...g.data?.competitiveAdvantages||[]],d.vulnerabilities=[...d.vulnerabilities||[],...g.data?.vulnerabilities||[]],e+=g.confidence,f++,c.sources.push("threat_assessment")):c.warnings.push(`Threat assessment failed: ${g.errors.join(", ")}`)}catch(a){c.warnings.push(`Threat assessment error: ${a instanceof Error?a.message:"Unknown error"}`)}return c.confidence=f>0?e/f:0,c.data=d,c.success=Object.keys(d).length>0,c}catch(a){return c.errors.push(`Enrichment failed: ${a instanceof Error?a.message:"Unknown error"}`),c}}async extractCompanyInfoFromWebsite(a){let b={success:!1,confidence:0,sources:["website_scraping"],errors:[],warnings:[]};try{let d,e,g,h,i;if(!this.checkRateLimit("website_scraping"))return b.errors.push("Rate limit exceeded for website scraping"),b;let{webScrapingService:j}=await Promise.all([c.e(7615),c.e(1993),c.e(6685)]).then(c.bind(c,76685)),k=a.startsWith("http")?a:`https://${a}`,l=await j.scrapeCompetitorWebsite(k);if(!l.success||!l.data)return b.errors.push(l.error||"Website scrape failed"),b;let m=l.data.content,n=(await Promise.all([c.e(7615),c.e(1993)]).then(c.bind(c,51993))).load(m),o=n('meta[name="description"]').attr("content")||n('meta[property="og:description"]').attr("content")||void 0;n('script[type="application/ld+json"]').each((a,b)=>{try{let a=JSON.parse(n(b).html()||"{}"),c=Array.isArray(a)?a.find(a=>"Organization"===a["@type"]):"Organization"===a["@type"]?a:null;if(c){if(o||"string"!=typeof c.description||(o=c.description),"string"==typeof c.foundingDate){let a=parseInt(c.foundingDate);Number.isNaN(a)||(g=a)}if("number"==typeof c.numberOfEmployees&&(h=c.numberOfEmployees),c.address&&"object"==typeof c.address){let a=c.address,b=[a.streetAddress,a.addressLocality,a.addressRegion,a.addressCountry].filter(Boolean);b.length&&(e=b.join(", "))}}let d=Array.isArray(a)?a.filter(a=>"Product"===a["@type"]):"Product"===a["@type"]?[a]:[];d.length&&(i=d.map(a=>({name:a.name,description:a.description,category:a.category,features:[],status:"active"})))}catch{}});let p=n.text().toLowerCase();for(let[a,b]of Object.entries(f))if(b.some(a=>p.includes(a))){d=a;break}return b.data={description:o,industry:d,headquarters:e,foundedYear:g,employeeCount:h,products:i},b.confidence=.7,b.success=!0,b}catch(a){return b.errors.push(`Website extraction error: ${a instanceof Error?a.message:"Unknown error"}`),b}}async discoverSocialMediaHandles(a,b){let d={success:!1,confidence:0,sources:["social_media_apis"],errors:[],warnings:[]};try{if(!this.checkRateLimit("social_media_discovery"))return d.errors.push("Rate limit exceeded for social media discovery"),d;let a={},e=0,f={},{webScrapingService:g}=await Promise.all([c.e(7615),c.e(1993),c.e(6685)]).then(c.bind(c,76685)),h=b?b.startsWith("http")?b:`https://${b}`:void 0;if(h){let a=await g.scrapeCompetitorWebsite(h);if(a.success&&a.data){let b=(await Promise.all([c.e(7615),c.e(1993)]).then(c.bind(c,51993))).load(a.data.content);b("a[href]").each((a,c)=>{let d=(b(c).attr("href")||"").trim(),e=d.startsWith("http")?d:d.startsWith("/")&&h?`${h}${d}`:"";e&&(!f.linkedin&&/linkedin\.com\/(company|in)\//i.test(e)&&(f.linkedin=e),!f.twitter&&/(twitter\.com|x\.com)\//i.test(e)&&(f.twitter=e),!f.facebook&&/facebook\.com\//i.test(e)&&(f.facebook=e),!f.instagram&&/instagram\.com\//i.test(e)&&(f.instagram=e),!f.youtube&&/youtube\.com\//i.test(e)&&(f.youtube=e))})}}for(let[b,c]of Object.entries(f))this.validateSocialMediaUrl(b,c)?(a[b]=c,e++):d.warnings.push(`Invalid ${b} URL: ${c}`);return e>0?(d.data={socialMediaHandles:a},d.confidence=Math.min(.8,.2*e),d.success=!0):d.warnings.push("No valid social media handles found"),d}catch(a){return d.errors.push(`Social media discovery error: ${a instanceof Error?a.message:"Unknown error"}`),d}}async identifyKeyPersonnel(a,b){let c={success:!1,confidence:0,sources:["linkedin_api","company_website"],errors:[],warnings:[]};try{if(!this.checkRateLimit("personnel_mapping"))return c.errors.push("Rate limit exceeded for personnel mapping"),c;let d=await this.identifyPersonnelFromWeb(a,b);return d.length>0?(c.data={keyPersonnel:d},c.confidence=Math.min(.7,.15*d.length),c.success=!0):c.warnings.push("No key personnel identified"),c}catch(a){return c.errors.push(`Personnel identification error: ${a instanceof Error?a.message:"Unknown error"}`),c}}async assessThreatLevel(a,b){let c={success:!1,confidence:0,sources:["market_analysis"],errors:[],warnings:[]};try{let d=0,e=[],f=[];if(a.employeeCount&&(a.employeeCount>1e3?(d+=30,e.push("Large workforce and resources")):a.employeeCount>100?(d+=20,e.push("Established team size")):a.employeeCount<20&&(d+=5,f.push("Limited workforce"))),a.fundingStage)switch(a.fundingStage){case"ipo":d+=40,e.push("Public company with significant resources");break;case"series-c":d+=30,e.push("Well-funded with proven market fit");break;case"series-b":d+=20,e.push("Growing company with investor backing");break;case"series-a":d+=15,e.push("Early-stage funding secured");break;case"seed":d+=10,f.push("Early-stage funding limitations")}if(a.industry&&b){let c=this.calculateIndustryOverlap(a.industry,b);d+=20*c,c>.7&&e.push("Direct market competitor")}if(a.products&&a.products.length>0){let b=a.products.filter(a=>"active"===a.status).length;d+=Math.min(5*b,25),b>5?e.push("Diverse product portfolio"):1===b&&f.push("Single product dependency")}if(a.socialMediaHandles){let b=Object.keys(a.socialMediaHandles).length;d+=2*b,b>=4&&e.push("Strong social media presence")}if(a.keyPersonnel&&a.keyPersonnel.length>0){let b=a.keyPersonnel.filter(a=>a.role.toLowerCase().includes("ceo")||a.role.toLowerCase().includes("cto")||a.role.toLowerCase().includes("founder")).length;d+=5*b,b>0&&e.push("Experienced leadership team")}return c.data={threatLevel:d>=75?"critical":d>=55?"high":d>=25?"medium":"low",competitiveAdvantages:e,vulnerabilities:f},c.confidence=.85,c.success=!0,c}catch(a){return c.errors.push(`Threat assessment error: ${a instanceof Error?a.message:"Unknown error"}`),c}}calculateIndustryOverlap(a,b){let c=a.toLowerCase().split(/\s+/),d=b.toLowerCase().split(/\s+/),e=0;for(let[a,b]of Object.entries(f)){let a=b.filter(a=>c.some(b=>b.includes(a))).length,f=b.filter(a=>d.some(b=>b.includes(a))).length;a>0&&f>0&&(e=Math.max(e,(a+f)/(2*b.length)))}return Math.max(e,c.filter(a=>d.some(b=>b.includes(a)||a.includes(b))).length/Math.max(c.length,d.length))}validateSocialMediaUrl(a,b){let c=e[a];return!!c&&c.test(b)}checkRateLimit(a){if(!this.config.respectRateLimit)return!0;let b=Date.now();return!(b-(this.rateLimitTracker.get(a)||0)<1e3)&&(this.rateLimitTracker.set(a,b),!0)}async identifyPersonnelFromWeb(a,b){try{let{webScrapingService:a}=await Promise.all([c.e(7615),c.e(1993),c.e(6685)]).then(c.bind(c,76685)),d=b.startsWith("http")?b:`https://${b}`,e=[],f=await Promise.all([c.e(7615),c.e(1993)]).then(c.bind(c,51993));for(let b of["/","/about","/team","/company","/about-us"]){let c="/"===b?d:`${d}${b}`,g=await a.scrapeCompetitorWebsite(c);if(!g.success||!g.data)continue;let h=f.load(g.data.content);if(h('script[type="application/ld+json"]').each((a,b)=>{try{let a=JSON.parse(h(b).html()||"{}");for(let b of Array.isArray(a)?a.filter(a=>"Person"===a["@type"]):"Person"===a["@type"]?[a]:[])e.push({name:b.name,role:b.jobTitle||"Executive",linkedinProfile:void 0,previousCompanies:[]})}catch{}}),h('[class*=team], [class*=leadership], section:contains("Team"), section:contains("Leadership")').find("h1,h2,h3,h4,h5").each((a,b)=>{let c=h(b).text().trim();if(c&&c.split(" ").length>=2){let a=h(b).next().text().trim()||"Team";e.push({name:c,role:a,linkedinProfile:void 0,previousCompanies:[]})}}),e.length>=10)break}let g=new Set;return e.filter(a=>{let b=a.name.toLowerCase();return!g.has(b)&&(g.add(b),!0)}).slice(0,10)}catch{return[]}}}let h=new g}};