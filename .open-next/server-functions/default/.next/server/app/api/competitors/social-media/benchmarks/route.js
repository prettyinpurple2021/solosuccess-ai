(()=>{var a={};a.id=2055,a.ids=[2055,4291],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12061:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>T,patchFetch:()=>S,routeModule:()=>O,serverHooks:()=>R,workAsyncStorage:()=>P,workUnitAsyncStorage:()=>Q});var d={};c.r(d),c.d(d,{GET:()=>G,POST:()=>H,dynamic:()=>E});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(30477),v=c(10641),w=c(74291),x=c(42981),y=c(74721),z=c(97356),A=c(41393),B=c(48689),C=c(2995),D=c(35559);let E="force-dynamic",F=C.Ik({competitor_ids:C.Yj().transform(a=>a.split(",").map(Number)),platform:C.k5(["linkedin","twitter","facebook","instagram","youtube"]).optional(),days:C.Yj().transform(Number).default("30"),metrics:C.Yj().transform(a=>a.split(",")).default("engagement,frequency,reach,sentiment")});async function G(a){try{let b=a.headers.get("x-forwarded-for")||"unknown",{allowed:c}=(0,x.E)("api",b,6e4,100);if(!c)return v.NextResponse.json({error:"Too many requests"},{status:429});let{user:d,error:e}=await (0,w.authenticateRequest)();if(e||!d)return v.NextResponse.json({error:"Unauthorized"},{status:401});let f=new URL(a.url),{competitor_ids:g,platform:h,days:i,metrics:j}=F.parse({competitor_ids:f.searchParams.get("competitor_ids")||"",platform:f.searchParams.get("platform"),days:f.searchParams.get("days")||"30",metrics:f.searchParams.get("metrics")||"engagement,frequency,reach,sentiment"});if(0===g.length)return v.NextResponse.json({error:"At least one competitor ID is required"},{status:400});if(g.length>10)return v.NextResponse.json({error:"Maximum 10 competitors allowed for benchmarking"},{status:400});let k=await z.db.select().from(A.competitorProfiles).where((0,B.Uo)((0,B.RV)(A.competitorProfiles.id,g),(0,B.eq)(A.competitorProfiles.user_id,d.id)));if(k.length!==g.length){let a=k.map(a=>a.id),b=g.filter(b=>!a.includes(b));return v.NextResponse.json({error:"Some competitors not found or not accessible",missing_competitor_ids:b},{status:404})}let l=await y.e.createCompetitiveBenchmarks(g,h,i),m=await I(l,k,j),n=function(a){let b={top_performers:[],underperformers:[],key_differentiators:[],market_trends:[]};if(0===a.length)return b;let c={};if(a.forEach(a=>{c[a.platform]||(c[a.platform]=[]),c[a.platform].push(a)}),Object.entries(c).forEach(([a,c])=>{let d=c.sort((a,b)=>(b.metrics.engagement?.value||0)-(a.metrics.engagement?.value||0));d.length>0&&b.top_performers.push({platform:a,competitor:d[0].competitor,metric:"engagement",value:d[0].metrics.engagement?.value||0});let e=Math.ceil(.25*d.length);d.slice(-e).forEach(c=>{b.underperformers.push({platform:a,competitor:c.competitor,areas:c.positioning.weaknesses||[]})});let f=c.flatMap(a=>a.positioning.strengths||[]),g={};f.forEach(a=>{g[a]=(g[a]||0)+1});let h=Object.entries(g).filter(([a,b])=>b>1).map(([a])=>a);b.key_differentiators.push(...h)}),b.market_trends.push("Social media engagement varies significantly by platform"),b.top_performers.length>0){let a=b.top_performers[0].platform;b.market_trends.push(`${a} shows highest competitive activity`)}return b}(m),o=function(a){let b={immediate_actions:[],strategic_initiatives:[],competitive_moves:[],platform_specific:{}};return a.forEach(a=>{let c=a.platform;if(b.platform_specific[c]||(b.platform_specific[c]=[]),a.recommendations&&a.recommendations.length>0&&b.platform_specific[c].push(...a.recommendations),a.positioning.rank>.7*a.positioning.totalCompetitors&&b.immediate_actions.push(`Improve ${c} performance - currently ranked ${a.positioning.rank}/${a.positioning.totalCompetitors}`),a.positioning.opportunities.length>0&&b.strategic_initiatives.push(...a.positioning.opportunities.map(a=>`${c}: ${a}`)),a.comparisons&&a.comparisons.length>0){let d=a.comparisons[0];d.advantages.length>0&&b.competitive_moves.push(`Counter ${d.competitorName}'s advantages on ${c}: ${d.advantages.join(", ")}`)}}),b.immediate_actions=[...new Set(b.immediate_actions)],b.strategic_initiatives=[...new Set(b.strategic_initiatives)],b.competitive_moves=[...new Set(b.competitive_moves)],b}(m);return v.NextResponse.json({success:!0,data:{analysis_period:{days:i,start_date:new Date(Date.now()-24*i*36e5),end_date:new Date},platform_filter:h||"all",metrics_analyzed:j,competitors:k.map(a=>({id:a.id,name:a.name,threat_level:a.threat_level,social_media_handles:a.social_media_handles})),benchmarks:m,comparative_insights:n,strategic_recommendations:o,summary:function(a){let b={total_competitors:a.length,platforms_analyzed:[...new Set(a.map(a=>a.platform))],avg_market_position:0,top_performing_platform:"",key_insights:[]};if(0===a.length)return b;let c=a.map(a=>a.positioning.rank/a.positioning.totalCompetitors);b.avg_market_position=Math.round(c.reduce((a,b)=>a+b,0)/c.length*100);let d={};return a.forEach(a=>{let b=a.metrics.engagement?.value||0;d[a.platform]=(d[a.platform]||0)+b}),b.top_performing_platform=Object.entries(d).reduce((a,[b,c])=>c>a[1]?[b,c]:a)[0],b.key_insights.push(`Analyzed ${b.total_competitors} competitors across ${b.platforms_analyzed.length} platforms`),b.key_insights.push(`Average market position: ${b.avg_market_position}th percentile`),b.key_insights.push(`Strongest performance on ${b.top_performing_platform}`),b}(m)}})}catch(a){if((0,u.vV)("Error generating competitive benchmarks:",a),a instanceof D.G)return v.NextResponse.json({error:"Invalid request parameters",details:a.errors},{status:400});return v.NextResponse.json({error:"Internal server error"},{status:500})}}async function H(a){try{let b,c=a.headers.get("x-forwarded-for")||"unknown",{allowed:d}=(0,x.E)("api",c,6e4,100);if(!d)return v.NextResponse.json({error:"Too many requests"},{status:429});let{user:e,error:f}=await (0,w.authenticateRequest)();if(f||!e)return v.NextResponse.json({error:"Unauthorized"},{status:401});let g=await a.json(),{competitor_ids:h,platform:i,days:j,metrics:k,benchmark_type:l,include_industry_averages:m}=C.Ik({competitor_ids:C.YO(C.ai()).min(1).max(10),platform:C.k5(["linkedin","twitter","facebook","instagram","youtube"]).optional(),days:C.ai().min(7).max(365).default(30),metrics:C.YO(C.k5(["engagement","frequency","reach","sentiment","growth"])).default(["engagement","frequency"]),benchmark_type:C.k5(["performance","content","timing","audience"]).default("performance"),include_industry_averages:C.zM().default(!1)}).parse(g),n=await z.db.select().from(A.competitorProfiles).where((0,B.Uo)((0,B.RV)(A.competitorProfiles.id,h),(0,B.eq)(A.competitorProfiles.user_id,e.id)));if(n.length!==h.length)return v.NextResponse.json({error:"Some competitors not found or not accessible"},{status:404});switch(l){case"performance":default:b=await J(h,i,j,k);break;case"content":b=await K(h,i,j);break;case"timing":b=await L(h,i,j);break;case"audience":b=await M(h,i,j)}return m&&(b.industry_averages=await N(n[0].industry||"",i)),v.NextResponse.json({success:!0,data:{benchmark_type:l,analysis_period:{days:j,start_date:new Date(Date.now()-24*j*36e5),end_date:new Date},platform_filter:i||"all",metrics_analyzed:k,competitors:n.map(a=>({id:a.id,name:a.name,threat_level:a.threat_level})),results:b}})}catch(a){if((0,u.vV)("Error creating custom benchmark:",a),a instanceof D.G)return v.NextResponse.json({error:"Invalid request parameters",details:a.errors},{status:400});return v.NextResponse.json({error:"Internal server error"},{status:500})}}async function I(a,b,c){return a.map(a=>{let d=b.find(b=>b.id===a.competitorId);return{competitor:{id:d.id,name:d.name,threat_level:d.threat_level},platform:a.platform,metrics:function(a,b){let c={};return b.forEach(b=>{a[b]&&(c[b]=a[b])}),c}(a.benchmarks,c),positioning:a.positioning,comparisons:a.comparison,insights:a.insights,recommendations:a.recommendations,analyzed_at:a.analyzedAt}})}async function J(a,b,c=30,d=[]){return{type:"performance",metrics:d,data:[]}}async function K(a,b,c=30){return{type:"content",data:[]}}async function L(a,b,c=30){return{type:"timing",data:[]}}async function M(a,b,c=30){return{type:"audience",data:[]}}async function N(a,b){return{engagement_rate:.03,posting_frequency:1.2,follower_growth_rate:.05,sentiment_score:.1}}let O=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/competitors/social-media/benchmarks/route",pathname:"/api/competitors/social-media/benchmarks",filename:"route",bundlePath:"app/api/competitors/social-media/benchmarks/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"C:\\Users\\prett\\Desktop\\SoloSuccess AI\\app\\api\\competitors\\social-media\\benchmarks\\route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:P,workUnitAsyncStorage:Q,serverHooks:R}=O;function S(){return(0,g.patchFetch)({workAsyncStorage:P,workUnitAsyncStorage:Q})}async function T(a,b,c){var d;let e="/api/competitors/social-media/benchmarks/route";"/index"===e&&(e="/");let g=await O.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:y,routerServerContext:z,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,resolvedPathname:C}=g,D=(0,j.normalizeAppPath)(e),E=!!(y.dynamicRoutes[D]||y.routes[C]);if(E&&!x){let a=!!y.routes[C],b=y.dynamicRoutes[D];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let F=null;!E||O.isDev||x||(F="/index"===(F=C)?"/":F);let G=!0===O.isDev||!E,H=E&&!G,I=a.method||"GET",J=(0,i.getTracer)(),K=J.getActiveScopeSpan(),L={params:v,prerenderManifest:y,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:G,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:H,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>O.onRequestError(a,b,d,z)},sharedContext:{buildId:u}},M=new k.NodeNextRequest(a),N=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(M,(0,l.signalFromNodeResponse)(b));try{let d=async c=>O.handle(P,L).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=J.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${I} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${I} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&A&&B&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=L.renderOpts.fetchMetrics;let i=L.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=L.renderOpts.collectedTags;if(!E)return await (0,o.I)(M,N,e,L.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,d=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await O.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:H,isOnDemandRevalidate:A})},z),b}},l=await O.handleResponse({req:a,nextConfig:w,cacheKey:F,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:y,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:B,responseGenerator:k,waitUntil:c.waitUntil});if(!E)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&E||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(M,N,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};K?await g(K):await J.withPropagatedContext(a.headers,()=>J.trace(m.BaseServerSpan.handleRequest,{spanName:`${I} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":I,"http.target":a.url}},g))}catch(b){if(K||b instanceof s.NoFallbackError||await O.onRequestError(a,b,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:H,isOnDemandRevalidate:A})}),E)throw b;return await (0,o.I)(M,N,new Response(null,{status:500})),null}}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30477:(a,b,c)=>{"use strict";c.d(b,{HG:()=>i,JE:()=>g,fH:()=>h,vF:()=>e,vV:()=>f});class d{constructor(){this.isDevelopment=!1,this.logLevel=this.isDevelopment?3:2}shouldLog(a){return a<=this.logLevel}formatLogEntry(a){let b=["ERROR","WARN","INFO","DEBUG"][a.level],c=`[${a.timestamp}] ${b}: ${a.message}`;return a.context&&Object.keys(a.context).length>0&&(c+=` | Context: ${JSON.stringify(a.context)}`),a.error&&(c+=` | Error: ${a.error.message}`,this.isDevelopment&&a.error.stack&&(c+=` | Stack: ${a.error.stack}`)),c}log(a,b,c,d){if(!this.shouldLog(a))return;let e={level:a,message:b,timestamp:new Date().toISOString(),context:c,error:d},f=this.formatLogEntry(e);0===a&&console.error(f),!this.isDevelopment&&a<=1&&this.sendToExternalService(e)}async sendToExternalService(a){}error(a,b,c){this.log(0,a,b,c)}warn(a,b){this.log(1,a,b)}info(a,b){this.log(2,a,b)}debug(a,b){this.log(3,a,b)}apiLog(a,b,c,d,e){let f=`${a} ${b} - ${c}${d?` (${d}ms)`:""}`,g=c>=500?0:c>=400?1:2;this.log(g,f,{method:a,path:b,statusCode:c,duration:d,...e})}dbLog(a,b,c,d){let e=`DB ${a} on ${b}${c?` (${c}ms)`:""}`;this.log(3,e,{operation:a,table:b,duration:c,...d})}authLog(a,b,c=!0,d){let e=`Auth ${a}${b?` for user ${b}`:""} - ${c?"SUCCESS":"FAILED"}`;this.log(c?2:1,e,{action:a,userId:b,success:c,...d})}}let e=new d,f=(a,b,c)=>{b instanceof Error?e.error(a,void 0,b):"object"==typeof b&&null!==b?e.error(a,b,c):e.error(a,void 0,c)},g=(a,b)=>e.warn(a,b),h=(a,b)=>e.info(a,b),i=(a,b,c,d,f)=>e.apiLog(a,b,c,d,f)},42981:(a,b,c)=>{"use strict";function d(a,b,c,d){let e,f=(globalThis.__rateLimits||(globalThis.__rateLimits=new Map),(e=globalThis.__rateLimits.get(a))||(e=new Map,globalThis.__rateLimits.set(a,e)),e),g=Date.now(),h=f.get(b);if(!h||g-h.ts>c)return f.set(b,{count:1,ts:g}),{allowed:!0,remaining:d-1};h.count+=1,h.ts=g;let i=Math.max(0,d-h.count);return{allowed:h.count<=d,remaining:i}}async function e(a,b){let c=function(a){let b=a.headers.get("x-forwarded-for");if(b)return b.split(",")[0].trim();let c=a.headers.get("x-real-ip");if(c)return c;let d=a.headers.get("cf-connecting-ip");return d||"127.0.0.1"}(a),e=d(a.url||"default",c,1e3*b.window,b.requests);return{...e,success:e.allowed}}function f(a,b,c,f){if(a instanceof Request&&"object"==typeof b)return e(a,b);if("string"==typeof a&&"string"==typeof b&&c&&f)return d(a,b,c,f);throw Error("Invalid rateLimitByIp arguments")}c.d(b,{E:()=>f})},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74291:(a,b,c)=>{"use strict";c.d(b,{_:()=>m,authenticateRequest:()=>l});var d=c(30477);c(10641);var e=c(86802),f=c(80829),g=c.n(f),h=c(94570),i=c(41393),j=c(48689);async function k(){try{let a=await (0,e.b3)(),b=a.get("authorization"),c=null;if(b&&b.startsWith("Bearer "))c=b.substring(7);else{let b=a.get("cookie");b&&(c=b.split(";").reduce((a,b)=>{let[c,d]=b.trim().split("=");return a[c]=d,a},{}).auth_token||null)}if(!c)return null;let d=g().verify(c,"local-development-jwt-secret-key");if(!d||!d.userId)return null;let f=(0,h.Lf)(),k=await f.select({id:i.users.id,email:i.users.email,full_name:i.users.full_name,username:i.users.username,date_of_birth:i.users.date_of_birth,created_at:i.users.created_at,updated_at:i.users.updated_at,subscription_tier:i.users.subscription_tier,subscription_status:i.users.subscription_status}).from(i.users).where((0,j.eq)(i.users.id,d.userId)).limit(1);if(0===k.length)return null;let l=k[0];return{id:l.id,email:l.email,full_name:l.full_name,name:l.full_name,username:l.username,created_at:l.created_at,updated_at:l.updated_at,subscription_tier:l.subscription_tier??"free",subscription_status:l.subscription_status??"active"}}catch(a){return(0,d.vV)("JWT authentication error:",a),null}}async function l(){try{let a=await k();if(a)return{user:a,error:null};return{user:null,error:"No authenticated user session found"}}catch(a){return(0,d.vV)("Authentication error:",a),{user:null,error:"Authentication failed"}}}async function m(a){try{let a=await l();return{user:a.user||void 0,error:a.error||void 0}}catch(a){return(0,d.vV)("verifyAuth error:",a),{error:"Authentication failed"}}}},78335:()=>{},80829:a=>{"use strict";a.exports=require("jsonwebtoken")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96487:()=>{},97356:(a,b,c)=>{"use strict";c.d(b,{db:()=>d.db});var d=c(94570);c(41393)}};var b=require("../../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[5873,1428,1692,9608,6802,2098,2995,4570,4721],()=>b(b.s=12061));module.exports=c})();