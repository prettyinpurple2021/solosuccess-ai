(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{84051:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>b});var t=i(95155),a=i(12115),r=i(20063),n=i(90883),c=i(97003),l=i(83209),d=i(32559),o=i(42529),u=i(26983),x=i(21873),m=i(79451),h=i(17910),v=i(52508),p=i(90627),g=i(78874);function b(){let[e,s]=(0,a.useState)(null),[i,b]=(0,a.useState)(!0),[N,j]=(0,a.useState)(!1),[w,y]=(0,a.useState)(""),f=(0,r.useRouter)();(0,a.useEffect)(()=>{A()},[]);let A=async()=>{try{let e={id:crypto.randomUUID(),deviceName:D(),deviceType:k(),ipAddress:"Loading...",userAgent:navigator.userAgent,location:"Loading...",requestedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+864e5).toISOString()};s(e)}catch(e){y("Failed to load device information")}finally{b(!1)}},D=()=>{let e=navigator.platform,s=navigator.userAgent;return e.includes("Mac")?"MacBook":e.includes("Win")?"Windows PC":e.includes("Linux")?"Linux PC":s.includes("iPhone")?"iPhone":s.includes("iPad")?"iPad":s.includes("Android")?"Android Device":"Unknown Device"},k=()=>{let e=navigator.userAgent;return e.includes("Mobile")?"mobile":e.includes("Tablet")?"tablet":"desktop"},S=async()=>{j(!0),y("");try{let{data:s,error:i}=await n.yK.multiSession.approveDevice({deviceFingerprint:crypto.randomUUID(),deviceName:(null==e?void 0:e.deviceName)||"Unknown Device",deviceType:(null==e?void 0:e.deviceType)||"desktop",trustDevice:!0});if(i)return void y(i.message);s&&f.push("/dashboard")}catch(e){y("Failed to approve device. Please try again.")}finally{j(!1)}},P=async()=>{f.push("/signin")};return i?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-4",children:(0,t.jsxs)(l.Zp,{className:"w-full max-w-2xl bg-white/10 backdrop-blur-lg border-white/20",children:[(0,t.jsxs)(l.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 w-16 h-16 bg-yellow-500/20 rounded-full flex items-center justify-center",children:(0,t.jsx)(h.A,{className:"w-8 h-8 text-yellow-400"})}),(0,t.jsx)(l.ZB,{className:"text-3xl font-bold text-white",children:"Device Approval Required"}),(0,t.jsx)(l.BT,{className:"text-gray-300",children:"A new device is trying to access your account. Please review and approve this request."})]}),(0,t.jsx)(l.Wu,{children:e&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white/5 rounded-lg p-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(e=>{switch(e.toLowerCase()){case"desktop":default:return(0,t.jsx)(m.A,{className:"w-8 h-8"});case"mobile":return(0,t.jsx)(v.A,{className:"w-8 h-8"});case"tablet":return(0,t.jsx)(p.A,{className:"w-8 h-8"})}})(e.deviceType),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-xl font-semibold text-white",children:e.deviceName}),(0,t.jsxs)("p",{className:"text-gray-300 capitalize",children:[e.deviceType," Device"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-300",children:[(0,t.jsx)(x.A,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Location: ",e.location]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-gray-300",children:[(0,t.jsx)(u.A,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Requested: ",new Date(e.requestedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]}),w&&(0,t.jsx)(d.Fc,{className:"bg-red-500/20 border-red-500/50",children:(0,t.jsx)(d.TN,{className:"text-red-200",children:w})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)(c.$,{onClick:S,disabled:N,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 mr-2"}),N?"Approving...":"Approve Device"]}),(0,t.jsxs)(c.$,{onClick:P,variant:"destructive",className:"flex-1 bg-red-600 hover:bg-red-700 text-white",children:[(0,t.jsx)(g.A,{className:"w-4 h-4 mr-2"}),"Deny Access"]})]}),(0,t.jsxs)("div",{className:"bg-blue-500/20 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-blue-200 font-semibold mb-2",children:"Security Notice"}),(0,t.jsx)("p",{className:"text-blue-100 text-sm",children:"Only approve this device if you recognize it and trust the location. If you don't recognize this device, deny access and consider changing your password."})]})]})})]})})}},96309:(e,s,i)=>{Promise.resolve().then(i.bind(i,84051))}},e=>{e.O(0,[6975,4228,3848,9809,8061,2807,1198,1159,5159,23,6529,5593,4180,3976,186,8790,5848,8861,9701,5147,4961,9168,4774,27,6308,563,4696,9173,9219,4409,3376,9765,7650,8920,871,6680,7358],()=>e(e.s=96309)),_N_E=e.O()}]);