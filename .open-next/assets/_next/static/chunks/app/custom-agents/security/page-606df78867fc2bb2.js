(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5080],{87168:(e,s,i)=>{Promise.resolve().then(i.bind(i,89647))},89647:(e,s,i)=>{"use strict";i.d(s,{SecurityDashboard:()=>v});var t=i(95155),n=i(2479),a=i(12115),l=i(83209),c=i(97003),r=i(67812),d=i(90923),x=i(32559),o=i(50906),m=i(52056),h=i(42529),u=i(26983),j=i(57828),g=i(99708),f=i(15870),N=i(17910),p=i(91169);function v(){let[e,s]=(0,a.useState)(null),[i,v]=(0,a.useState)([]),[y,b]=(0,a.useState)(null),[A,w]=(0,a.useState)(!0),[S,R]=(0,a.useState)("roxy");(0,a.useEffect)(()=>{Z()},[]);let Z=async()=>{try{w(!0);let e=await fetch("/api/custom-agents/security?action=metrics"),i=await e.json();i.success&&s(i.metrics);let t=[];for(let e of["roxy","blaze","echo","lumi","vex","lexi","nova","glitch"]){let s=await fetch("/api/custom-agents/security?action=permissions&agentId=".concat(e)),i=await s.json();i.success&&t.push(i.permissions)}v(t);let n=await fetch("/api/custom-agents/security?action=config"),a=await n.json();a.success&&b(a.config)}catch(e){(0,n.vV)("Error loading security data:",e)}finally{w(!1)}},E=(e,s)=>e.includes("*")?"full":e.length>0&&0===s.length?"partial":s.length>0?"restricted":"none";if(A)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})});let B=i.find(e=>e.agentId===S);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Security Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Monitor and manage AI agent security"})]}),(0,t.jsxs)(c.$,{onClick:Z,variant:"outline",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Refresh Security Data"]})]}),e&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ZB,{className:"text-sm font-medium",children:"Active Sessions"}),(0,t.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.activeSessions}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Currently logged in"})]})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ZB,{className:"text-sm font-medium",children:"Audit Logs (24h)"}),(0,t.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:e.totalAuditLogs.toLocaleString()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Security events logged"})]})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ZB,{className:"text-sm font-medium",children:"Failed Auth Attempts"}),(0,t.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:e.failedAuthAttempts}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"In the last 24 hours"})]})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(l.ZB,{className:"text-sm font-medium",children:"Rate Limit Hits"}),(0,t.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(l.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:e.rateLimitHits}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Rate limit exceeded"})]})]})]}),(0,t.jsxs)(d.tU,{defaultValue:"permissions",className:"space-y-4",children:[(0,t.jsxs)(d.j7,{children:[(0,t.jsx)(d.Xi,{value:"permissions",children:"Permissions"}),(0,t.jsx)(d.Xi,{value:"configuration",children:"Configuration"}),(0,t.jsx)(d.Xi,{value:"monitoring",children:"Monitoring"})]}),(0,t.jsxs)(d.av,{value:"permissions",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Select Agent:"}),(0,t.jsx)("select",{value:S,onChange:e=>R(e.target.value),className:"px-3 py-1 border rounded-md","aria-label":"Select agent to view permissions",children:i.map(e=>(0,t.jsx)("option",{value:e.agentId,className:"capitalize",children:e.agentId},e.agentId))})]}),B&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Access Status"}),(0,t.jsxs)(l.BT,{children:["Current permission level for ",S]})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat((e=>{switch(e){case"full":return"bg-green-500";case"partial":return"bg-blue-500";case"restricted":return"bg-yellow-500";case"none":return"bg-red-500";default:return"bg-gray-500"}})(E(B.permissions,B.restrictions)))}),(0,t.jsx)("span",{className:"font-medium",children:(e=>{switch(e){case"full":return"Full Access";case"partial":return"Partial Access";case"restricted":return"Restricted Access";case"none":return"No Access";default:return"Unknown"}})(E(B.permissions,B.restrictions))})]}),B.expiresAt&&(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Expires: ",new Date(B.expiresAt).toLocaleDateString()]})]})})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Permissions & Restrictions"}),(0,t.jsx)(l.BT,{children:"Detailed access control settings"})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-green-600 mb-2",children:"Allowed Actions"}),(0,t.jsx)("div",{className:"space-y-1",children:B.permissions.length>0?B.permissions.map((e,s)=>(0,t.jsx)(r.E,{variant:"outline",className:"bg-green-50 text-green-700",children:e},s)):(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"No specific permissions"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-red-600 mb-2",children:"Restricted Actions"}),(0,t.jsx)("div",{className:"space-y-1",children:B.restrictions.length>0?B.restrictions.map((e,s)=>(0,t.jsx)(r.E,{variant:"outline",className:"bg-red-50 text-red-700",children:e},s)):(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"No restrictions"})})]})]})})]})]})]}),(0,t.jsx)(d.av,{value:"configuration",className:"space-y-4",children:y&&(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Security Settings"}),(0,t.jsx)(l.BT,{children:"Current security configuration"})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Authentication Required"}),(0,t.jsx)(r.E,{variant:y.requireAuthentication?"default":"secondary",children:y.requireAuthentication?"Enabled":"Disabled"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Authorization Required"}),(0,t.jsx)(r.E,{variant:y.requireAuthorization?"default":"secondary",children:y.requireAuthorization?"Enabled":"Disabled"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Rate Limiting"}),(0,t.jsx)(r.E,{variant:y.enableRateLimiting?"default":"secondary",children:y.enableRateLimiting?"Enabled":"Disabled"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Audit Logging"}),(0,t.jsx)(r.E,{variant:y.enableAuditLogging?"default":"secondary",children:y.enableAuditLogging?"Enabled":"Disabled"})]})]})})]}),(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Session Settings"}),(0,t.jsx)(l.BT,{children:"Session management configuration"})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Max Concurrent Sessions"}),(0,t.jsx)("div",{className:"text-2xl font-bold",children:y.maxConcurrentSessions})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Session Timeout"}),(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[Math.round(y.sessionTimeoutMs/6e4)," minutes"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Allowed Origins"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[y.allowedOrigins.length," configured"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Blocked IPs"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[y.blockedIPs.length," blocked"]})]})]})})]})]})}),(0,t.jsx)(d.av,{value:"monitoring",className:"space-y-4",children:(0,t.jsxs)(l.Zp,{children:[(0,t.jsxs)(l.aR,{children:[(0,t.jsx)(l.ZB,{children:"Security Monitoring"}),(0,t.jsx)(l.BT,{children:"Real-time security monitoring and alerts"})]}),(0,t.jsx)(l.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(x.Fc,{children:[(0,t.jsx)(N.A,{className:"h-4 w-4"}),(0,t.jsxs)(x.TN,{children:[(0,t.jsx)("div",{className:"font-medium",children:"Security Status: Active"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"All security systems are operational and monitoring agent interactions."})]})]}),(0,t.jsxs)(x.Fc,{children:[(0,t.jsx)(h.A,{className:"h-4 w-4"}),(0,t.jsxs)(x.TN,{children:[(0,t.jsx)("div",{className:"font-medium",children:"Authentication: Enabled"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"User authentication is required for all agent interactions."})]})]}),(0,t.jsxs)(x.Fc,{children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),(0,t.jsxs)(x.TN,{children:[(0,t.jsx)("div",{className:"font-medium",children:"Authorization: Active"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"Permission-based access control is enforced for all agents."})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(c.$,{variant:"outline",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Configure Security"]}),(0,t.jsxs)(c.$,{variant:"outline",children:[(0,t.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"View Audit Logs"]})]})]})})]})})]})]})}}},e=>{e.O(0,[5848,8861,9701,5147,4961,9168,4774,27,6308,563,4696,9173,9219,4409,3376,9765,7650,8920,871,6680,6975,4228,3848,9809,8061,2807,1198,1159,5159,23,6529,5593,4180,3976,186,8790,7358],()=>e(e.s=87168)),_N_E=e.O()}]);